{"version":3,"sources":["webpack://exports/webpack/bootstrap","webpack://exports/./src/my-command.js","webpack://exports/external \"sketch\"","webpack://exports/external \"sketch/ui\""],"names":["document","sketch","getSelectedDocument","pages","desingTokensPages","filter","page","selected","desingTokensPage","UI","alert","selectPage","artboard","layers","console","log","jsonContent","frame","width","height","background","color","poster_shapes","poster_image","poster_text","export_layers","forEach","layer","i","item","name","type","style","push","getSVGPath","jsonStr","JSON","stringify","defaultFileName","contents","save","NSSavePanel","savePanel","setNameFieldStringValue","setAllowsOtherFileTypes","setExtensionHidden","runModal","file","NSString","stringWithString","path","URL","imagePath","replace","exportOptions","formats","scales","output","index","export_item","export","writeToFile_atomically_encoding_error","NSUTF8StringEncoding"],"mappings":"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","file":"__my-command.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/my-command.js\");\n","import sketch from 'sketch'\nimport UI from \"sketch/ui\";\n\n// documentation: https://developer.sketchapp.com/reference/api/\n\nexport default function() {\n\n  // console.log('This is an example Sketch script.')\n\n  var document = sketch.getSelectedDocument()\n  var pages = document.pages\n  const desingTokensPages = pages.filter(page => page.selected === true)\n  const desingTokensPage = desingTokensPages[0]\n  if (!desingTokensPage) {\n    UI.alert(\"请选择目标页面\", \"未选中页面\");\n    return\n  }\n  var selectPage = pages[0]\n  var artboard = selectPage.layers[0]\n  console.log(artboard)\n  var jsonContent = {\n    \"canvas_w\": artboard.frame.width,\n    \"canvas_h\": artboard.frame.height,\n    \"bg_color\": artboard.background.color\n  }\n  var poster_shapes = []\n  var poster_image = []\n  var poster_text = []\n  var export_layers = []\n  artboard.layers.forEach(function (layer, i) {\n    var item = {\n        \"frame\": layer.frame,\n        \"name\": layer.name,\n        \"level\": i,\n        \"type_name\": layer.type\n    }\n    if (layer.type == 'Text') {\n      item[\"style\"] = layer.style\n      item[\"layer_type\"] = 1\n      poster_text.push(item)\n    }else if (layer.type == 'Image') {\n      item[\"layer_type\"] = 2\n      poster_image.push(item)\n    }else if (layer.type == 'ShapePath') {\n      item[\"svg\"] = layer.getSVGPath()\n      item[\"layer_type\"] = 3\n      poster_shapes.push(item)\n    }\n    export_layers.push(layer)\n\n  })\n  jsonContent[\"layer_shapes\"] = poster_shapes\n  jsonContent[\"layer_images\"] = poster_image\n  jsonContent[\"layer_texts\"] = poster_text\n\n  let jsonStr = JSON.stringify(jsonContent)\n  let defaultFileName = \"config.json\"\n  let contents = jsonStr\n  let save = NSSavePanel.savePanel();\n  save.setNameFieldStringValue(defaultFileName);\n  save.setAllowsOtherFileTypes(false);\n  save.setExtensionHidden(false);\n\n  if (save.runModal()) {\n    let file = NSString.stringWithString(contents);\n    let path = save.URL().path();\n\n    var imagePath = path\n    imagePath = imagePath.replace(\"/\"+defaultFileName, \"\")\n     const exportOptions = {\n          formats: 'png',\n          scales: '2x',\n          output: imagePath,\n        }\n    for (let index in export_layers) {\n        var export_item = export_layers[index]\n        export_item.name = export_item.name\n        sketch.export(export_item, exportOptions)\n    }\n\n\n    file.writeToFile_atomically_encoding_error(path, true, NSUTF8StringEncoding, null);\n    UI.alert(\"保存成功\", path);\n  }\n\n\n  // console.log(JSON.stringify(jsonContent))\n  // sketch.UI.message(JSON.stringify(jsonStr))\n}\n","module.exports = require(\"sketch\");","module.exports = require(\"sketch/ui\");"],"sourceRoot":""}